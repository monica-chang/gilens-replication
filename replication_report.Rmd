---
title: "Replication Report"
author: "Monica Chang"
date: "4/24/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(rstanarm)
library(foreign)
library(stargazer)
library(arm)
library(haven)
library(lavaan)
library(modEvA)
library(dplyr)
library(xtable)
library(statxp)
library(gt)
library(gridExtra)
```

## Overview of the original paper

### What question(s) did the author(s) ask?  

In the paper "Testing Theories of American Politics: Elites, Interest Groups, 
and Average Citizens" by Martin Gilens and Benjamin Page, the authors attempt to
answer the following question: Which of the four theoretical traditions in the 
study of American politics - Majoritarian Electoral Democracy, Economic-Elite 
Domination, Majoritarian Pluralism, Biased Pluralism - provides the most 
accurate picture of American politics?

These theories each offer different predictions over how much independent 
influence the median voter, economic elites, mass-based interest groups, and 
business-oriented interest groups have on public policy:

- Majoritarian Electoral Democracy posits that only the median voter has 
substantial independent influence on policy outcomes.

- Economic-Elite Domination posits that economic elites have the most
independent influence on policy outcomes, with the median voter and 
interest groups playing a smaller role.

- Majoritarian Pluralism posits that only organized interest groups will have
substantial independent influence on policy outcomes. In particular, this 
theory assumes that the stands of all interest groups, taken together, generally 
represent the preferences of average citizens. 

- Biased Pluralism posits that only organized interest groups will have
substantial independent influence on policy outcomes. In particular, this theory
predicts that business-oriented interest groups play a larger role.

Gilens and Page aim to test these four theoretical traditions within one
statistical model.

### How did they create their dataset? What were their variables of interest? 

To conduct this analysis, Gilens assembled a unique dataset of 1,779 instances 
between 1981 and 2002 in which a national survey of the general public asked a 
favor/oppose question about a proposed policy change.

For each survey question, Gilens' team did the following work to prepare a 
unique dataset:

- Use the available income breakdown for each survey question's 
respondents to estimate the opinions of respondents at the 10th income 
percentile, the 50th percentile, and the 90th percentile. 

- Record how many engaged powerful interest groups were strongly in favor of, 
somewhat in favor of, somewhat opposed, or strongly opposed to the proposed 
policy change in each question. This allowed Gilens to develop a measure of
Net Interest Group Alignment for all interest groups, mass-based interest 
groups, and business-oriented interest groups.

- Track whether the proposed policy change was actually adopted within 4 years
after the question was asked.

Predictor variables:

- Policy preferences at the 50th income percentile work as a proxy for the 
preferences of the median voter.

- Policy preferences at the 90th income percentile work as a proxy for the 
preferences of the economic elite.

- Net Interest Group Alignment scores work as a proxy for the preferences
of all interest groups, mass-based interest groups, and business-oriented 
interest groups.

Outcome variable:

- Whether or not the proposed policy change was adopted within 4 years.

### What analyses did they run? What models did they use?

First, they create a correlation matrix (Table 2) to assess the correlation
between independent variables. This helps test one of Majoritarian Pluralism's
predictions - that the stands of all interest groups are positively correlated 
with the preferences of average citizens. 

Then, they use structural equation modeling to regress policy outcome on
the preferences of the median voter, the preferences of the economic elite,
and the preferences of all interest groups (Table 3) to evaluate support 
for Majoritarian Electoral Democracy, Economic Elite Domination, and interest
group pluralism.

Finally, they regress policy outcome on the preferences of the median voter, 
the preferences of the economic elite, the preferences of mass-based interest 
groups, and the preferences of business-oriented interest groups to distinguish
between Majoritarian Pluralism and Biased Pluralism (Table 4).

### Why did they choose structural equation modeling?

They chose structural equation modeling to correct for correlated measurement 
error. Because the measures for two independent variables - the preferences of 
the 50th percentile voter and the preferences of the 90th percentile voter - 
come from a single data source (the same set of national opinion surveys), it 
is highly likely that the errors of these two measures are positively correlated 
with each other. These correlated errors tend to produce upwardly biased
statistical relationships between the two independent variables. This decision 
is further explained in Appendix 2 of their paper.

### What did they conclude?

Gilens and Page conclude that economic elites and business-oriented interest 
groups have substantial independent impacts on U.S. policy, while mass-based 
interest groups and average citizens have little or no independent influence. 
Their results support theories of Economic-Elite Domination and Biased 
Pluralism.

## Overview of my replication

For my replication, I first cleaned Gilens' publicly provided data according 
to the criteria laid out in the paper (excluding questions without an
income breakdown, where the policy was partially adopted, or if the policy 
change required a Constitutional amendment or Supreme Court ruling).

```{r clean data, include = FALSE}
# I load the data from SPSS files from here:
# https://www.russellsage.org/datasets/economic-inequality-and-political-representation 

path = file.path("raw_data/DS1_v2_0.sav")
gilens = read_sav(path)

write_csv(gilens,"raw_data/DS1_v2_0.csv" )

# I clean the dataset to exclude questions about policy changes that would
# require a constitutional amendment or Supreme Court ruling, proposed changes 
# that were partially but not fully adopted, and questions that lacked income 
# breakdowns. 1,779 questions from 1981–2002 remain for the analyses.

clean_gilens <- gilens %>%
  clean_names() %>%
  
  # I exclude the 27 questions where there is no income breakdown.
  
  filter(!is.na(pred50_sw)) %>%
  
  # I exclude the 57 questions where the policy was partially adopted.
  
  filter(outcome != 2.5 & outcome != 3.5 & outcome != 4.5) 
  
  # None of the remaining questions require a Constitutional amendment or a 
  # new Supreme Court ruling to bring about the proposed policy change - so
  # I do not need to apply an additional filter.
```

After filtering the dataset to only include the 1,779 survey questions that
met the criteria, I cleaned the dataset to prepare it for modeling:

I turned the outcome variable into a dichotomous variable so that it was coded 1 
if the proposed policy change took place within four years of the survey date 
and 0 if it did not.

I calculated Net Interest Group Alignment scores for all interest groups,
mass-based interest groups, and business-oriented interest groups for each
survey question by using the formula described in the paper:

$$ Net Interest-Group Alignment = ln(# Strongly Favor + [0.5 * # Somewhat Favor] + 1) - ln(# Strongly Oppose + [0.5 * # Somewhat Oppose] + 1). $$
I took the logits of the imputed percent of respondents at the 
50th and 90th income percentiles that favored the proposed policy change. 

I standardized all predictors to be on a scale of 0 to 1. 

```{r calculate and normalize predictors, include = FALSE}
clean_gilens <- clean_gilens %>%
  
  # I turn the outcome variable into a dichotomous variable.
  
  mutate(policy_change = if_else(outcome > 0, 1, 0)) %>%
  
  # I calculate the net interest group alignment score by using the formula 
  # described in the paper.
  
  mutate(intgrp_align = (log(intgrp_stfav + (0.5 * intgrp_swfav) + 1)) - 
                      (log(intgrp_stopp + (0.5 * intgrp_swopp) + 1))) %>%
  
  # I normalize the net interest group alignment score to be on a scale from 0 
  # to 1.
  
  mutate(intgrp_align_norm = range01(intgrp_align)) %>%
  
  # I use qlogis() to take the logit of the imputed percent of respondents at 
  # the 10th, 50th, and 90th income percentiles that favor the proposed policy 
  # change. I then use range01() to normalize my predictors to be on a scale 
  # from 0 to 1.
  
  mutate(pred10_norm = range01(qlogis(pred10_sw)),
         pred50_norm = range01(qlogis(pred50_sw)),
         pred90_norm = range01(qlogis(pred90_sw))) 
```

```{r add interest group alignment scores for mass-based & business interest groups}
  
add_scores <- function(df){
  
  df <- df %>%
    # I initialize 8 columns to track the number of mass-based and business
    # interest groups that are strongly in favor, somewhat in favor, somewhat
    # opposed, or strongly opposed to the policy change in each question.
    
    mutate(mass_intgrp_stfav = 0) %>%
    mutate(mass_intgrp_swfav = 0) %>%
    mutate(mass_intgrp_stopp = 0) %>%
    mutate(mass_intgrp_swopp = 0) %>%
    mutate(bus_intgrp_stfav = 0) %>%
    mutate(bus_intgrp_swfav = 0) %>%
    mutate(bus_intgrp_stopp = 0) %>%
    mutate(bus_intgrp_swopp = 0) 
  
  # I initialize two vectors to hold the indexes of the columns in clean_gilens
  # that hold the favor/oppose values for mass-based and business-oriented 
  # groups.
  
  mass_indexes = c(216, 217, 222, 224, 225, 230, 237, 248, 249, 256, 258)
  business_indexes = c(218, 219, 220, 221, 223, 226 ,227, 228, 229, 231,232, 233, 
                       234, 235, 236, 238, 239, 240, 241, 242, 243, 245, 247, 250, 
                       251, 252, 253, 254, 255)
  
  # I loop through each row of the dataframe.
  
  for (i in nrow(df)) {
    
    # I loop through each of the interest group columns for each row.
    
    for(j in 216:258){
      
       # If the interest group is a mass-based interest group, I add to the
       # appropriate counter based on the value.
      
       if(j %in% mass_indexes){
          if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == 2) {
             df[i,][271] <- df[i,][271] + 1
          } else if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == 1) {
             df[i,][272] <- df[i,][272] + 1
          } else if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == -2) {
             df[i,][273] <- df[i,][273] + 1
          } else if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == -1) {
             df[i,][274] <- df[i,][274] + 1
          } else {
             df[i,][271] <- df[i,][271]*1
          }
         
       # If the interest group is a business-oriented interest group, I add to 
       # the appropriate counter based on the value.
         
       } else if(j %in% business_indexes) {
          if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == 2) {
             df[i,][275] <- df[i,][275] + 1
          } else if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == 1) {
             df[i,][276] <- df[i,][276] + 1
          } else if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == -2) {
             df[i,][277] <- df[i,][277] + 1
          } else if (!is.na(df[i,][j][[1]][1]) & df[i,][j][[1]][1] == -1) {
             df[i,][278] <- df[i,][278] + 1
          } else {
             df[i,][271] <- df[i,][271]*1
          }
         
       # If the interest group is not a mass-based or business-oriented 
       # interest group, I do nothing.
         
       } else {
         df[i,][271] <- df[i,][271]*1
       }
        
    }
  }
  
  return(df)
  
}

add_scores(clean_gilens)

clean_gilens <- clean_gilens %>%
  
  # I calculate the net interest group alignment scores for mass-based interest
  # groups and business interest groups by using the formula described in the 
  # paper.
  
  mutate(mass_intgrp_align = (log(mass_intgrp_stfav + (0.5 * mass_intgrp_swfav) + 1)) - 
                      (log(mass_intgrp_stopp + (0.5 * mass_intgrp_swopp) + 1)),
         bus_intgrp_align = (log(bus_intgrp_stfav + (0.5 * bus_intgrp_swfav) + 1)) - 
                      (log(bus_intgrp_stopp + (0.5 * bus_intgrp_swopp) + 1))) %>%
  
  # I normalize the net interest group alignment scores for mass-based interest
  # groups and business interest groups to be on a scale from 0 to 1.
  
  mutate(mass_intgrp_align_norm = range01(mass_intgrp_align),
         bus_intgrp_align_norm = range01(bus_intgrp_align)) 

# ASK LE: How to make this more concise/use a loop?
```

```{r generate table 1}
# I initialize the appropriate values for sets of actors that would 
# have independent influence for each of the theories of U.S. politics.

table_1 <- tibble(theories = c("Majoritarian Electoral Democracy", 
                               "Dominance by Economic Elites", 
                               "Majoritarian Pluralism", 
                               "Biased Pluralism"),
                  pred50_norm = c("Y", "y", "y", "n"),
                  pred90_norm = c("n", "Y", "n", "n"),
                  intgrp_align_norm = c("n", "y", "Y", "y"),
                  mass_intgrp_align_norm = c("n", "n", "Y", "y"),
                  bus_intgrp_align_norm = c("n", "y", "Y", "Y"))

# I format the table using gt() functions.

table_1 %>%
  gt(rowname_col = "theories") %>%
  tab_header(
    title = "Table 1",
    subtitle = glue::glue("Theoretical predictions concerning the independent influence of sets of actors upon policy outcomes")
  ) %>%
  tab_spanner(
    label = "Sets of Actors",
    columns = c("pred50_norm", "pred90_norm", "intgrp_align_norm", "mass_intgrp_align_norm", "bus_intgrp_align_norm")
  ) %>%
  cols_label(pred50_norm = "Average Citizens",
             pred90_norm = "Economic Elites",
             intgrp_align_norm = "All Interest Groups",
             mass_intgrp_align_norm = "Mass Interest Groups",
             bus_intgrp_align_norm = "Business Interest Groups") %>%
  tab_source_note(
    source_note = "n = little or no independent influence"
  ) %>%
  tab_stubhead(label = "Theory (ideal type)") %>%
  tab_source_note(
    source_note = "y = some independent influence"
  ) %>%
  tab_source_note(
    source_note = "Y = substantial independent influence"
  )
```

```{r generate table 2}
# I select the five predictors relevant for Table 2.

table_2 <- clean_gilens %>%
  dplyr::select(pred50_norm, pred90_norm, intgrp_align_norm, 
                mass_intgrp_align_norm, bus_intgrp_align_norm)

# I use the corstars() function to compute a correlation matrix with stars to
# indicate significant correlations.

table_2_correlation <- corstars(table_2) %>%
  mutate(predictors = c("Average citizens’ preferences", "Economic elites’ preferences", 
                        "All interest groups", "Mass public interest groups", 
                        "Business interest groups"))

# I format the table using gt() functions.

table_2_correlation %>%
  gt(rowname_col = "predictors") %>%
  tab_header(
    title = "Table 2",
    subtitle = glue::glue("Correlations among independent variables")
  ) %>%
  cols_label(pred50_norm = "Average citizens’ preferences",
             pred90_norm = "Economic elites’ preferences",
             intgrp_align_norm = "All interest groups",
             mass_intgrp_align_norm = "Mass public interest groups") %>%
  tab_source_note(
    source_note = "***p<.001; n = 1779."
  ) %>%
  tab_source_note(
    source_note = "Note: Entries are correlation coefficients based on OLS regression coefficients - not SEM modeling."
  )
```

Because structural equation modeling is outside the scope of this course, I 
use OLS regression instead. I am able to check whether my results are correct
based on Table A1 in Appendix 2 - an OLS analysis that Gilens provides that is 
parallel to the structural equation model presented in Table 3. This difference 
in model choice means that my tables and figure are all slightly different from 
those shown in the paper.

Besides this modeling difference, I fully replicate the four tables and one 
figure that appear in the paper.

b) What can you conclude? 

The results from the OLS regression due not lead to the same conclusions as 
Gilens and Page. It would seem that the correction for measurement error and
their choice of structural equation modeling is crucial to get their key finding
- the fact that the median voter has no significant independent influence.

Based on my replicated Table 2, the 

Based on my replicated Table 3, my coefficient values for the bivariate 
regression models (Models 1-3) are quite similar to those in the paper. However,
my results are significantly different when it comes to the multivariate model
(Model 4). 
 
Whereas the coefficient for the median voter in Gilens and Page's paper is 
statistically and substantively insignificant, the coefficient for the median
voter is negative, substantial, and statistically significant in my replication.
In other words, my replication indicates that a median voter's preference in 
favor of a policy change is associated with a negative influence on the policy
outcome.

The extremely negative coefficient for the median voter and the extremely large
positive coefficient for economic elites suggests the presence of 
correlated measurement error.


```{r generate table 3}
# I run a model where the preferences of the median voter is the sole predictor 
# of policy change.

model_1 <- lm(policy_change ~ pred50_norm, data = clean_gilens)
summary(model_1)

# I run a model where the preferences of the 90th percentile voter is the sole 
# predictor of policy change.

model_2 <- lm(policy_change ~ pred90_norm, data = clean_gilens)
summary(model_2)

# I run a model where the interest group alignment is the sole predictor of 
# policy change.

model_3 <- lm(policy_change ~ intgrp_align_norm, data = clean_gilens)
summary(model_3)

# I run a multivariate model where the preferences of the median voter, the 
# preferences of the 90th percentile voter, and the interest group alignment
# are predictors of policy change.

model_4 <- lm(policy_change ~ pred50_norm + pred90_norm + intgrp_align_norm, data = clean_gilens)
summary(model_4)

# I use the procedure on p. 56 in the textbook to standardize my coefficients.

clean_gilens_2 <- clean_gilens %>%
  
  # I subtract the mean and divide by 2 standard deviations.
  
  mutate(z.pred50 = (pred50_norm - mean(pred50_norm))/(2*sd(pred50_norm)),
         z.pred90 = (pred90_norm - mean(pred90_norm))/(2*sd(pred90_norm)),
         z.intgrp = (intgrp_align_norm - mean(intgrp_align_norm))/(2*sd(intgrp_align_norm)))

model_5 <- lm(policy_change ~ z.pred50 + z.pred90 + z.intgrp, data = clean_gilens_2)
summary(model_5)

# I use stargazer() to format a table with 3 regressions side-by-side.

stargazer(model_1, model_2, model_3, model_4, 
          type = "html", 
          title = "Table 3. Policy outcomes and the policy preferences of average citizens, economic elites, and interest groups",
          align = TRUE,
          dep.var.labels = c("Policy change"),
          column.labels = c("Model 1", "Model 2", "Model 3", "Model 4"),
          covariate.labels = c("Preferences of average citizens", 
                               "Preferences of economic elites", 
                               "Alignment of interest groups"),
          omit.stat=c("LL","ser","f", "adj.rsq", "n"), 
          no.space=TRUE,
          notes = c("*p<0.1; **p<0.05; ***p<0.01", "All predictors are scaled to range from 0 to 1. The dependent variable is the policy outcome, coded 1 if the proposed policy change took place within four years of the survey date and 0 if it did not. Predictors are the logits of the imputed percent of respondents at the fiftieth (“average citizens”) or ninetieth (“economic elites”) income percentile that favor the proposed policy change, and the Net Interest- Group Alignment Index described in the text. Standard errors are asymptotically distribution-free, and all analyses reflect estimated measurement error in the predictors, as described in Appendix 2. The standardized coefficients for model 4 in this table are -0.22, .41, and .15 for average citizens, economic elites, and interest groups, respectively. N = 1,779."),
          notes.align = "l",
          notes.append = FALSE)
```


```{r figure 1}

b <- coef(model_4)

# I create the first plot in Figure 1.

plot_1 <- clean_gilens %>%
  
  # I multiply pred50_sw to obtain a number that represents the percentage 
  # of median voters in favor of a proposed policy change.
  
  mutate(pred50_sw_percent = 100*pred50_sw) %>%
  ggplot(aes(pred50_sw_percent)) +
  
    # I use a histogram to display the underlying preference distribution.
  
    geom_histogram(aes(y = after_stat(count/sum(count))),
                   alpha = 0.5, 
                   bins = 10, 
                   position = "identity") +
  
    # I use the coefficients from my Model 4 output and the neutral points of 
    # the other two actors - 0.5 for economic elites and 0 for interest group
    # alignment - to construct a line graph that shows how the predicted 
    # probability of policy change alters when moving from one point to another 
    # on the distribution of policy dispositions.
  
    geom_line(aes(y = invlogit(b[1] + b[2]*pred50_norm + b[3]*0.5 + b[4]*0))) +
    xlim(0, 100) +
    
    # I customize the Y scales to have dual axes.
  
    scale_y_continuous(
      
      # I specify the name and limits of the lefthand axis.
      
      name = "Predicted probability of adoption",
      limits = c(0, 0.7),
      
      # I specify the name and limits of the second axis by transforming
      # the first axis.
      
      sec.axis = sec_axis(trans = ~.*0.5714, 
                          name = "Percent of cases (grey columns)")
    ) +
    labs(title = "Average Citizens' Preferences",
         x = "Percent favoring proposed policy change") +
    theme_classic()

# I create the second plot in Figure 1.

plot_2 <- clean_gilens %>%
  
  # I multiply pred90_sw to obtain a number that represents the percentage 
  # of median voters in favor of a proposed policy change.
  
  mutate(pred90_sw_percent = 100*pred90_sw) %>%
  ggplot(aes(pred90_sw_percent)) +
  
    # I use a histogram to display the underlying preference distribution.
  
    geom_histogram(aes(y = after_stat(count/sum(count))),
                   alpha = 0.5, 
                   bins = 10, 
                   position = "identity") +
  
    # I use the coefficients from my Model 4 output and the neutral points of 
    # the other two actors - 0.5 for average citizens and 0 for interest group
    # alignment - to construct a line graph that shows how the predicted 
    # probability of policy change alters when moving from one point to another 
    # on the distribution of policy dispositions.
  
    geom_line(aes(y = invlogit(b[1] + b[2]*0.5 + b[3]*pred90_norm + b[4]*0))) +
    xlim(0, 100) +
    
    # I customize the Y scales to have dual axes.
  
    scale_y_continuous(
      
      # I specify the name and limits of the lefthand axis.
      
      name = "Predicted probability of adoption",
      limits = c(0, 0.7),
      
      # I specify the name and limits of the second axis by transforming
      # the first axis.
      
      sec.axis = sec_axis(trans = ~.*0.5714, 
                          name = "Percent of cases (grey columns)")
    ) +
    labs(title = "Economic Elites' Preferences",
         x = "Percent favoring proposed policy change") +
    theme_classic()

# I create the third graph in Figure 1.

plot_3 <- clean_gilens %>%
  
  ggplot(aes(intgrp_align)) +
  
    # I use a histogram to display the underlying preference distribution.
  
    geom_histogram(aes(y = after_stat(count/sum(count))),
                   alpha = 0.5, 
                   bins = 12, 
                   position = "identity") +
  
    # I use the coefficients from my Model 4 output and the neutral points of 
    # the other two actors - 0.5 for average citizens and 0.5 got economic 
    # elites - to construct a line graph that shows how the predicted 
    # probability of policy change alters when moving from one point to another 
    # on the distribution of policy dispositions.
  
    geom_line(aes(y = invlogit(b[1] + b[2]*0.5 + b[3]*0.5 + b[4]*intgrp_align_norm))) +
    xlim(-4, 4) +
    
    # I customize the Y scales to have dual axes.
  
    scale_y_continuous(
      
      # I specify the name and limits of the lefthand axis.
      
      name = "Predicted probability of adoption",
      limits = c(0, 0.7),
      
      # I specify the name and limits of the second axis by transforming
      # the first axis.
      
      sec.axis = sec_axis(trans = ~.*0.5714, 
                          name = "Percent of cases (grey columns)")
    ) +
    labs(title = "Interest Group Alignments",
         x = "Net interest groups in support or opposition") +
    theme_classic()

grid.arrange(
  plot_1,
  plot_2,
  plot_3,
  nrow = 3,
  top = "Figure 1. \n Predicted probability of policy adoption (dark \nlines, left axes) by policy disposition; the \ndistribution of preferences (gray columns,\n right axes"
)
```

```{r generate table 4}
# I run a multivariate model where the preferences of the median voter, the 
# preferences of the 90th percentile voter, and the interest group alignment
# cores of mass-based and business interest groups are predictors of policy 
# change.

model_6 <- lm(policy_change ~ pred50_norm + pred90_norm + mass_intgrp_align_norm + bus_intgrp_align_norm, data = clean_gilens)
summary(model_6)

# I use stargazer() to format a table of the regression output.

stargazer(model_6,
          type = "html", 
          title = "Table 4. The separate policy impact of business- oriented and mass-based interest groups",
          align = TRUE,
          dep.var.labels = c("Policy change"),
          covariate.labels = c("Average citizens’ preferences", 
                               "Economic elites’ preferences", 
                               "Mass-based interest groups",
                               "Business interest groups"),
          omit.stat=c("LL","ser","f", "adj.rsq", "n"), 
          no.space=TRUE,
          notes = c("*p<0.1; **p<0.05; ***p<0.01", "All predictors are scaled to range from 0 to 1. The dependent variable is the policy outcome, coded 1 if the proposed policy change took place within four years of the survey date and 0 if it did not. Predictors are the logits of the imputed percent of respondents at the fiftieth (“average citizens”) or ninetieth (“economic elites”) income percentile that favor the proposed policy change, and the Net Interest- Group Alignment Indices described in the text. Standard errors are asymptotically distribution-free, and all analyses reflect estimated measurement error in the predictors, as described in Appendix 2. N = 1,779."),
          notes.align = "l",
          notes.append = FALSE)
```

## Extension of the paper

I extended the replication by adding in a variable to indicate whether the
party of the President in the year of the survey question was a Democrat or a 
Republican.

I was curious about whether certain party control was associated with better or
worse governmental responsiveness to the median voter.

```{r regenerate table 3 for extension}

# I generate the equivalent of Table 3 - except this time with logistic 
# regressions instead of OLS regressions. I call this Table 5.

# I run a model where the preferences of the median voter is the sole predictor 
# of policy change.

model_1.logit <- glm(formula = policy_change ~ pred50_norm, 
                     family = binomial(link = "logit"), 
                     data = clean_gilens)
summary(model_1.logit)

# I run a model where the preferences of the 90th percentile voter is the sole 
# predictor of policy change.

model_2.logit <- glm(formula = policy_change ~ pred90_norm, 
               family = binomial(link = "logit"), 
               data = clean_gilens)
summary(model_2.logit)

# I run a model where the interest group alignment is the sole predictor of 
# policy change.

model_3.logit <- glm(formula = policy_change ~ intgrp_align_norm, 
                     family = binomial(link = "logit"), 
                     data = clean_gilens)
summary(model_3.logit)

# I run a multivariate model where the preferences of the median voter, the 
# preferences of the 90th percentile voter, and the interest group alignment
# are predictors of policy change.

model_4.logit <- glm(formula = policy_change ~ pred50_norm + pred90_norm + intgrp_align_norm, 
                     family = binomial(link = "logit"), 
                     data = clean_gilens)
summary(model_4.logit)

model_5.logit <- glm(policy_change ~ z.pred50 + z.pred90 + z.intgrp, 
                     family = binomial(link = "logit"), 
                     data = clean_gilens_2)
summary(model_5.logit)

# I use stargazer() to format a table with 3 regressions side-by-side.

stargazer(model_1.logit, model_2.logit, model_3.logit, model_4.logit, 
          type = "html", 
          title = "Table 3B. Policy outcomes and the policy preferences of average citizens, economic elites, and interest groups",
          align = TRUE,
          dep.var.labels = c("Policy change"),
          column.labels = c("Model 1", "Model 2", "Model 3", "Model 4"),
          covariate.labels = c("Preferences of average citizens", 
                               "Preferences of economic elites", 
                               "Alignment of interest groups"),
          omit.stat=c("LL", "n"), 
          no.space=TRUE,
          notes = c("*p<0.1; **p<0.05; ***p<0.01", "All predictors are scaled to range from 0 to 1. The dependent variable is the policy outcome, coded 1 if the proposed policy change took place within four years of the survey date and 0 if it did not. Predictors are the logits of the imputed percent of respondents at the fiftieth (“average citizens”) or ninetieth (“economic elites”) income percentile that favor the proposed policy change, and the Net Interest-Group Alignment Index described in the text. Standard errors are asymptotically distribution-free, and all analyses reflect estimated measurement error in the predictors, as described in Appendix 2. The standardized coefficients for model 4 in this table are -1.11, 2.03, and .69 for average citizens, economic elites, and interest groups, respectively. N = 1,779."),
          notes.align = "l",
          notes.append = FALSE)

# ASK LE: How to bootstrap standard errors?
# ASK LE: Does it make sense to use a logistic regression for extension if predictors are already the logits of the imputed percents?
```

```{r regenerate figure 1 for extension}

b <- coef(model_4.logit)

# I create the first plot in Figure 1.

plot_1 <- clean_gilens %>%
  
  # I multiply pred50_sw to obtain a number that represents the percentage 
  # of median voters in favor of a proposed policy change.
  
  mutate(pred50_sw_percent = 100*pred50_sw) %>%
  ggplot(aes(pred50_sw_percent)) +
  
    # I use a histogram to display the underlying preference distribution.
  
    geom_histogram(aes(y = after_stat(count/sum(count))),
                   alpha = 0.5, 
                   bins = 10, 
                   position = "identity") +
  
    # I use the coefficients from my Model 4 output and the neutral points of 
    # the other two actors - 0.5 for economic elites and 0 for interest group
    # alignment - to construct a line graph that shows how the predicted 
    # probability of policy change alters when moving from one point to another 
    # on the distribution of policy dispositions.
  
    geom_line(aes(y = invlogit(b[1] + b[2]*pred50_norm + b[3]*0.5 + b[4]*0))) +
    xlim(0, 100) +
    
    # I customize the Y scales to have dual axes.
  
    scale_y_continuous(
      
      # I specify the name and limits of the lefthand axis.
      
      name = "Predicted probability of adoption",
      limits = c(0, 0.7),
      
      # I specify the name and limits of the second axis by transforming
      # the first axis.
      
      sec.axis = sec_axis(trans = ~.*0.5714, 
                          name = "Percent of cases (grey columns)")
    ) +
    labs(title = "Average Citizens' Preferences",
         x = "Percent favoring proposed policy change") +
    theme_classic()

# I create the second plot in Figure 1.

plot_2 <- clean_gilens %>%
  
  # I multiply pred90_sw to obtain a number that represents the percentage 
  # of median voters in favor of a proposed policy change.
  
  mutate(pred90_sw_percent = 100*pred90_sw) %>%
  ggplot(aes(pred90_sw_percent)) +
  
    # I use a histogram to display the underlying preference distribution.
  
    geom_histogram(aes(y = after_stat(count/sum(count))),
                   alpha = 0.5, 
                   bins = 10, 
                   position = "identity") +
  
    # I use the coefficients from my Model 4 output and the neutral points of 
    # the other two actors - 0.5 for average citizens and 0 for interest group
    # alignment - to construct a line graph that shows how the predicted 
    # probability of policy change alters when moving from one point to another 
    # on the distribution of policy dispositions.
  
    geom_line(aes(y = invlogit(b[1] + b[2]*0.5 + b[3]*pred90_norm + b[4]*0))) +
    xlim(0, 100) +
    
    # I customize the Y scales to have dual axes.
  
    scale_y_continuous(
      
      # I specify the name and limits of the lefthand axis.
      
      name = "Predicted probability of adoption",
      limits = c(0, 0.7),
      
      # I specify the name and limits of the second axis by transforming
      # the first axis.
      
      sec.axis = sec_axis(trans = ~.*0.5714, 
                          name = "Percent of cases (grey columns)")
    ) +
    labs(title = "Economic Elites' Preferences",
         x = "Percent favoring proposed policy change") +
    theme_classic()

# I create the third graph in Figure 1.

plot_3 <- clean_gilens %>%
  
  ggplot(aes(intgrp_align)) +
  
    # I use a histogram to display the underlying preference distribution.
  
    geom_histogram(aes(y = after_stat(count/sum(count))),
                   alpha = 0.5, 
                   bins = 12, 
                   position = "identity") +
  
    # I use the coefficients from my Model 4 output and the neutral points of 
    # the other two actors - 0.5 for average citizens and 0.5 got economic 
    # elites - to construct a line graph that shows how the predicted 
    # probability of policy change alters when moving from one point to another 
    # on the distribution of policy dispositions.
  
    geom_line(aes(y = invlogit(b[1] + b[2]*0.5 + b[3]*0.5 + b[4]*intgrp_align_norm))) +
    xlim(-4, 4) +
    
    # I customize the Y scales to have dual axes.
  
    scale_y_continuous(
      
      # I specify the name and limits of the lefthand axis.
      
      name = "Predicted probability of adoption",
      limits = c(0, 0.7),
      
      # I specify the name and limits of the second axis by transforming
      # the first axis.
      
      sec.axis = sec_axis(trans = ~.*0.5714, 
                          name = "Percent of cases (grey columns)")
    ) +
    labs(title = "Interest Group Alignments",
         x = "Net interest groups in support or opposition") +
    theme_classic()

grid.arrange(
  plot_1,
  plot_2,
  plot_3,
  nrow = 3,
  top = "Figure 1B. \n Predicted probability of policy adoption (dark \nlines, left axes) by policy disposition; the \ndistribution of preferences (gray columns,\n right axes"
)
```
```{r regenerate table 4 for extension}
# I run a multivariate model where the preferences of the median voter, the 
# preferences of the 90th percentile voter, and the interest group alignment
# cores of mass-based and business interest groups are predictors of policy 
# change.

model_6.logit <- glm(policy_change ~ pred50_norm + pred90_norm + mass_intgrp_align_norm + bus_intgrp_align_norm, 
                      family = binomial(link = "logit"), 
                     data = clean_gilens)
summary(model_6.logit)

# I use stargazer() to format a table of the regression output.

stargazer(model_6.logit,
          type = "html", 
          title = "Table 4. The separate policy impact of business- oriented and mass-based interest groups",
          align = TRUE,
          dep.var.labels = c("Policy change"),
          covariate.labels = c("Average citizens’ preferences", 
                               "Economic elites’ preferences", 
                               "Mass-based interest groups",
                               "Business interest groups"),
          omit.stat=c("LL","ser","f", "adj.rsq", "n"), 
          no.space=TRUE,
          notes = c("*p<0.1; **p<0.05; ***p<0.01", "All predictors are scaled to range from 0 to 1. The dependent variable is the policy outcome, coded 1 if the proposed policy change took place within four years of the survey date and 0 if it did not. Predictors are the logits of the imputed percent of respondents at the fiftieth (“average citizens”) or ninetieth (“economic elites”) income percentile that favor the proposed policy change, and the Net Interest- Group Alignment Indices described in the text. Standard errors are asymptotically distribution-free, and all analyses reflect estimated measurement error in the predictors, as described in Appendix 2. N = 1,779."),
          notes.align = "l",
          notes.append = FALSE)
```

## Bibliography

Hlavac, Marek (2018). stargazer: Well-Formatted Regression and Summary Statistics
Tables. R package version 5.2.2. https://CRAN.R-project.org/package=stargazer

